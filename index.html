<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Final: Quadrinhos e Tirinhas</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bangers&family=Roboto:wght@400;500;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 40px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-image: url('https://static.vecteezy.com/system/resources/previews/007/382/137/large_2x/retro-comic-background-superhero-cartoon-style-free-vector.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }
        
        #start-screen {
            background-color: rgba(255, 255, 255, 0.98);
            padding: 40px 50px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 500px;
        }
        
        #start-screen h1 {
            font-family: 'Bangers', cursive;
            font-size: 3.5em;
            color: #D90429;
            margin: 0 0 10px 0;
            letter-spacing: 2px;
            text-shadow: 3px 3px #000;
        }

        #start-screen p {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 25px;
        }

        #nickname-input {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ccc;
            border-radius: 5px;
            margin-bottom: 20px;
            box-sizing: border-box;
        }
        
        #start-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.3em;
            font-weight: bold;
            color: #fff;
            background-color: #EF233C;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            transition: background-color 0.3s, transform 0.2s;
        }
        #start-btn:hover {
            background-color: #D90429;
            transform: scale(1.05);
        }

        #main-content { display: none; }

        #quiz-container {
            background-color: rgba(255, 255, 255, 0.98);
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 800px;
            padding: 20px 40px 40px 40px;
        }

        #quiz-container h1 {
            font-family: 'Bangers', cursive;
            font-size: 2.5em;
            color: #D90429;
            text-align: center;
            text-transform: uppercase;
            border-bottom: 3px solid #000;
            padding-bottom: 15px;
            margin-top: 0;
            letter-spacing: 1px;
            text-shadow: 2px 2px #fdfd96;
        }

        /* --- ESTILOS DO PLACAR E STREAK --- */
        #stats-container {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-box {
            font-family: 'Bangers', cursive;
            text-align: center;
            font-size: 1.8em;
            color: #3b3a60;
            padding: 10px;
            border: 3px solid #fdfd96;
            background-color: #f8f9fa;
            border-radius: 8px;
            letter-spacing: 2px;
            flex: 1;
        }

        #current-score, #current-streak {
            color: #D90429;
            font-size: 1.2em;
            transition: transform 0.2s ease-out;
        }

        .streak-updated {
            animation: streak-update 0.5s ease-out;
        }
        @keyframes streak-update {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); color: #ffc107; }
            100% { transform: scale(1); }
        }


        #history-container { margin-top: 40px; padding-top: 20px; border-top: 2px dashed #ccc; }
        #history-container h2 { text-align: center; color: #3b3a60; }
        #history-log table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        #history-log th, #history-log td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        #history-log th { background-color: #f2f2f2; color: #333; }
        #history-log tr:nth-child(even) { background-color: #f9f9f9; }

        .question-block { 
            margin-bottom: 20px; padding: 20px; border: 2px solid #f0f2f5; border-radius: 8px; transition: all 0.4s ease; background-color: #fff; display: none;
        }
        .question-block.active { display: block; }
        .question-block.correct { background-color: #e8f5e9; border-color: #4caf50; }
        .question-block.incorrect { background-color: #ffebee; border-color: #f44336; }
        .options label.correct-answer-highlight { border: 2px solid #4caf50; background-color: #c8e6c9; font-weight: 500; }
        .options label.wrong-answer-highlight { border: 2px solid #f44336; background-color: #ffcdd2; text-decoration: line-through; }

        h3 { font-size: 1.2em; color: #1c1c38; margin-bottom: 15px; font-weight: 500; }
        .options label { display: block; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; padding: 12px 15px; margin-bottom: 10px; cursor: pointer; transition: background-color 0.3s, border-color 0.3s; }
        .options label:hover { background-color: #e9ecef; border-color: #adb5bd; }
        .options input[type="radio"] { margin-right: 12px; transform: scale(1.1); }
        .hint-container { margin-top: 15px; }
        .hint-btn { background-color: #6c757d; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.9em; }
        .hint-btn:hover { background-color: #5a6268; }
        .hint-btn:disabled { background-color: #adb5bd; cursor: not-allowed; }
        .hint-text { display: none; margin-top: 10px; padding: 10px; background-color: #fffbe6; border-left: 4px solid #fbc02d; font-style: italic; }
        
        .explanation { display: none; margin-top: 15px; }
        .score-breakdown {
            background-color: #e7f3fe;
            border-left: 4px solid #2196f3;
            padding: 12px;
            margin-bottom: 10px;
            font-size: 0.95em;
        }
        .score-breakdown div { padding: 2px 0; }
        .score-breakdown .total-points {
            font-weight: bold;
            color: #0056b3;
            border-top: 1px solid #ccc;
            margin-top: 5px;
            padding-top: 5px;
        }
        .explanation-text {
            padding: 12px; 
            background-color: #e7f3fe; 
            border-left: 4px solid #2196f3; 
            font-size: 0.95em; 
            line-height: 1.5; 
        }

        .action-buttons { margin-top: 20px; }
        .check-btn, .next-btn {
            width: 100%; padding: 12px; font-size: 1.1em; font-weight: bold; color: #fff; border: none; border-radius: 5px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
        }
        .check-btn { background-color: #007bff; }
        .check-btn:hover { background-color: #0056b3; }
        .check-btn:disabled { background-color: #adb5bd; cursor: not-allowed; }
        .next-btn { background-color: #28a745; display: none; }
        .next-btn:hover { background-color: #1e7e34; }

        .timer-container {
            text-align: right; font-weight: bold; font-size: 1.2em; color: #3b3a60; margin-bottom: 15px;
        }
        .timer {
            display: inline-block;
            min-width: 2ch;
            text-align: center;
            color: #28a745;
            padding: 2px 8px;
            border-radius: 4px;
            background-color: #f0f2f5;
            transition: all 0.3s ease;
        }
        .timer.warning {
            color: #fff;
            background-color: #dc3545;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
        }

        #results { margin-top: 30px; padding: 20px; background-color: #f0f2f5; border-radius: 8px; text-align: center; }
        #results-text { font-size: 1.4em; font-weight: bold; color: #3b3a60; }
        #results-extra { font-size: 1.1em; color: #5a6268; margin-top: 10px; }
        #results-gif { margin-top: 20px; max-width: 300px; border-radius: 8px; }
    </style>
</head>
<body>
    <audio id="tension-audio" src="https://www.zapsplat.com/wp-content/uploads/2015/sound-design/Ticking_Tension_01_96_sec_version.mp3" preload="auto" loop></audio>
    <audio id="fast-tick-audio" src="https://www.zapsplat.com/wp-content/uploads/2015/sound-design/Ticking_Tension_04_no_musical_elements.mp3" preload="auto" loop></audio>

    <div id="start-screen">
        <h1>Quiz dos Quadrinhos</h1>
        <p>Digite seu apelido de herói (ou vilão) para entrar no ranking!</p>
        <input type="text" id="nickname-input" placeholder="Ex: O Incrível Dev">
        <button id="start-btn">Começar o Quiz!</button>
    </div>

    <div id="main-content">
        <div id="quiz-container">
            <h1>Quiz: Quadrinhos e Tirinhas</h1>
            <div id="stats-container">
                <div id="score-container" class="stat-box">
                    Pontuação: <span id="current-score">0</span>
                </div>
                <div id="streak-container" class="stat-box">
                    Streak: <span id="current-streak">1.0x</span>
                </div>
            </div>
            <form id="quizForm"></form>
            <div id="results" style="display: none;"></div>
            <div id="history-container" style="display: none;">
                <h2>Histórico de Pontuações</h2>
                <div id="history-log"></div>
            </div>
        </div>
    </div>

    <script>
        const quizData = [
            // ... (As 25 perguntas permanecem aqui) ...
            { question: "Em uma história em quadrinhos, o espaço entre um quadrinho e outro, geralmente em branco, é chamado de:", options: ["Legenda", "Sarjeta ou canaleta", "Balão", "Recordatório"], answer: "Sarjeta ou canaleta", hint: "Pense no espaço que 'divide' as cenas e que o leitor precisa 'preencher' com sua imaginação.", explanation: "A sarjeta ou canaleta é o termo técnico para o espaço que separa os quadrinhos. É nesse intervalo que a mente do leitor conecta uma cena à outra, inferindo a passagem de tempo e a ação." },
            { question: "Qual é a principal função das onomatopeias nas histórias em quadrinhos?", options: ["Representar os pensamentos dos personagens.", "Indicar a fala do narrador da história.", "Descrever o cenário onde a história acontece.", "Representar graficamente os sons."], answer: "Representar graficamente os sons.", hint: "Lembre-se de palavras como 'BUM!', 'CRASH!', 'TRIMMM!'", explanation: "Onomatopeias são palavras que imitam sons do ambiente, como explosões (BUM!), batidas (POW!) ou sons de animais (MIAU!), tornando a experiência de leitura mais imersiva e dinâmica." },
            { question: "Um balão de fala com linhas pontilhadas ou tracejadas geralmente indica que o personagem está:", options: ["Gritando", "Cochichando ou falando baixo", "Cantando", "Pensando"], answer: "Cochichando ou falando baixo", hint: "Pense em como se representaria visualmente um som que mal se pode ouvir.", explanation: "O formato do balão altera o sentido da fala. Balões pontilhados ou tracejados indicam um tom de voz baixo, como um sussurro ou cochicho. Gritos são representados por balões com pontas e pensamento por balões em formato de nuvem." },
            { question: "As linhas cinéticas, pequenos traços desenhados perto de personagens ou objetos, servem para indicar:", options: ["Emoção de surpresa", "A direção do som", "Movimento", "A passagem do tempo"], answer: "Movimento", hint: "Imagine um personagem correndo. O que o desenhista acrescentaria para mostrar a velocidade?", explanation: "Linhas cinéticas são um recurso da linguagem não verbal dos quadrinhos para criar a ilusão de movimento. Elas podem indicar a velocidade, a direção e a trajetória de um objeto ou personagem." },
            { question: "Qual é a principal característica que diferencia uma tirinha de uma história em quadrinhos (HQ) mais longa?", options: ["A presença de humor.", "O uso de linguagem não verbal.", "O formato curto e a publicação regular.", "A ausência de personagens fixos."], answer: "O formato curto e a publicação regular.", hint: "Pense em onde você costuma encontrar tirinhas, como em jornais diários.", explanation: "A principal diferença é o formato. Tirinhas são narrativas extremamente curtas (geralmente 3 ou 4 quadros) e publicadas com alta frequência (diária, semanal) em jornais, revistas e na internet." },
            { question: "A combinação da linguagem verbal (texto nos balões e legendas) e da linguagem não verbal (imagens, expressões) é um exemplo de:", options: ["Pleonasmo", "Linguagem mista ou multimodal", "Metáfora", "Prosa"], answer: "Linguagem mista ou multimodal", hint: "Como chamamos a comunicação que usa mais de um 'modo' (texto, imagem, som) para passar uma mensagem?", explanation: "Os quadrinhos são o exemplo clássico de linguagem mista ou multimodal, pois constroem sentido a partir da interdependência entre o texto escrito (linguagem verbal) e as imagens, cores e diagramação (linguagem não verbal)." },
            { question: "Nas tirinhas da personagem Mafalda, de Quino, qual é o tema mais recorrente que gera humor e crítica?", options: ["Aventuras de fantasia em mundos imaginários.", "Piadas sobre animais falantes.", "As preocupações sociais e políticas de uma criança.", "Situações cômicas envolvendo esportes."], answer: "As preocupações sociais e políticas de uma criança.", hint: "Mafalda é famosa por suas perguntas incômodas aos adultos sobre o estado do mundo.", explanation: "A genialidade de Quino está em usar a perspectiva de uma criança para fazer críticas profundas e bem-humoradas sobre a política, a sociedade, a guerra e as desigualdades, expondo as contradições do mundo adulto." },
            { question: "Quando o texto de um balão e a imagem do personagem se contradizem, o efeito de sentido gerado é, geralmente, a:", options: ["Ironia", "Hipérbole", "Comparação", "Confusão"], answer: "Ironia", hint: "Pense em um personagem que diz 'Estou ótimo!' enquanto sua expressão facial mostra profunda tristeza.", explanation: "A ironia é uma figura de linguagem frequentemente construída nos quadrinhos pelo choque entre o que é dito (linguagem verbal) e o que é mostrado (linguagem não verbal). Essa contradição gera humor ou crítica." },
            { question: "O que são 'personagens-tipo' nos quadrinhos?", options: ["Personagens que mudam de personalidade a cada história.", "Personagens que representam uma classe social, uma profissão ou um traço de personalidade de forma caricata.", "Os protagonistas da história.", "Personagens que aparecem em apenas uma história."], answer: "Personagens que representam uma classe social, uma profissão ou um traço de personalidade de forma caricata.", hint: "Pense em personagens que são definidos por uma única característica muito forte, como o Cascão da Turma da Mônica.", explanation: "Personagens-tipo são construídos com base em estereótipos facilmente reconhecíveis (o herói, o vilão, o cientista maluco). Isso permite que o leitor os identifique rapidamente, embora possam ser planos ou caricatos." },
            { question: "A quebra da 'quarta parede' em uma história em quadrinhos acontece quando:", options: ["Um personagem destrói um cenário.", "A história é contada em ordem não cronológica.", "Dois personagens conversam por telefone.", "Um personagem fala diretamente com o leitor."], answer: "Um personagem fala diretamente com o leitor.", hint: "Imagine um personagem que olha diretamente para você e faz um comentário sobre a própria história.", explanation: "A 'quarta parede' é a barreira imaginária que separa a ficção da realidade do público. Quando um personagem interage com o leitor (olhando para ele, fazendo perguntas), essa barreira é 'quebrada', criando um efeito cômico ou metalinguístico." },
            { question: "Qual dos seguintes elementos é fundamental para a construção do humor em muitas tirinhas?", options: ["A descrição detalhada dos cenários.", "A quebra de expectativa no último quadrinho.", "O uso de uma linguagem extremamente formal.", "A ausência total de diálogos."], answer: "A quebra de expectativa no último quadrinho.", hint: "Pense na estrutura de uma piada: uma preparação seguida de um desfecho surpreendente.", explanation: "Muitas tirinhas baseiam seu humor na quebra de expectativa. Os primeiros quadros criam uma situação lógica e previsível, mas o último quadro apresenta uma conclusão inesperada, ilógica ou absurda, que é o que provoca o riso." },
            { question: "A sequência de quadros em uma história em quadrinhos serve principalmente para:", options: ["Mostrar diferentes pontos de vista do mesmo evento.", "Confundir o leitor sobre a ordem dos acontecimentos.", "Construir a passagem do tempo e a narrativa.", "Apenas para decorar a página."], answer: "Construir a passagem do tempo e a narrativa.", hint: "Como o cinema usa a sequência de cenas para contar uma história?", explanation: "A justaposição de quadros é a essência da narrativa em quadrinhos. A sequência de imagens fixas, lidas em ordem, cria a ilusão de movimento e a passagem do tempo, permitindo que uma história se desenvolva." },
            { question: "Qual figura de linguagem é frequentemente associada ao recurso visual do 'zoom' ou close-up no rosto de um personagem?", options: ["Eufemismo", "Metonímia", "Hipérbole", "Antítese"], answer: "Hipérbole", hint: "Quando um desenhista foca intensamente em uma expressão facial, ele está... a importância daquela emoção.", explanation: "O close-up no rosto de um personagem, destacando uma emoção (raiva, surpresa, alegria), funciona como uma hipérbole visual. É um exagero gráfico para dar ênfase e intensificar o sentimento para o leitor." },
            { question: "Em tirinhas que não possuem texto (tirinhas mudas), qual elemento se torna o mais importante para a compreensão?", options: ["O título da tirinha.", "O conhecimento prévio do leitor sobre os personagens.", "As cores utilizadas pelo autor.", "A linguagem corporal e as expressões faciais dos personagens."], answer: "A linguagem corporal e as expressões faciais dos personagens.", hint: "Se não há palavras, como os personagens 'falam' e expressam seus sentimentos?", explanation: "Nas tirinhas mudas, toda a carga narrativa recai sobre a linguagem não verbal. A postura, os gestos, as expressões faciais e a sequência de ações são os únicos elementos que o leitor tem para compreender a história e os sentimentos dos personagens." },
            { question: "O uso de um balão de pensamento junto a um balão de fala para o mesmo personagem revela:", options: ["A diferença entre o que o personagem pensa e o que ele realmente fala.", "Que o personagem está confuso e não sabe o que dizer.", "Um erro de diagramação do quadrinista.", "Que o personagem tem o poder de telepatia."], answer: "A diferença entre o que o personagem pensa e o que ele realmente fala.", hint: "Pense na diferença entre nosso mundo interior e o que mostramos para os outros.", explanation: "Este é um recurso narrativo poderoso para mostrar o conflito interno de um personagem. Ele revela a diferença entre seus pensamentos verdadeiros (no balão de nuvem) e o que ele diz em voz alta (no balão de fala), criando ironia ou mostrando sua hipocrisia." },
            { question: "No universo Marvel, qual o nome do metal indestrutível que compõe o esqueleto de Wolverine e o escudo do Capitão América?", options: ["Vibranium", "Adamantium", "Kryptonita", "Uru"], answer: "Adamantium", hint: "O escudo do Capitão América é, na verdade, uma liga de Vibranium e um proto-Adamantium. O esqueleto de Wolverine é revestido com Adamantium secundário.", explanation: "Adamantium é uma liga metálica fictícia virtualmente indestrutível. Embora o escudo do Capitão América seja famoso por seu Vibranium, o esqueleto de Wolverine é o exemplo mais icônico do uso de Adamantium." },
            { question: "Qual famoso mangá de Masashi Kishimoto conta a história de um jovem ninja que sonha em se tornar o líder de sua vila?", options: ["Dragon Ball", "One Piece", "Naruto", "Bleach"], answer: "Naruto", hint: "O protagonista é conhecido por seu macacão laranja e por ter uma raposa de nove caudas selada dentro de si.", explanation: "'Naruto' é uma das séries de mangá e anime mais populares do mundo, narrando a jornada de Naruto Uzumaki para se tornar o Hokage, o ninja mais forte e respeitado de sua vila." },
            { question: "O termo 'graphic novel' (romance gráfico) é frequentemente usado para descrever HQs que se diferenciam por:", options: ["Serem sempre sobre super-heróis.", "Terem um formato mais longo, com narrativas complexas e temas maduros.", "Serem publicadas exclusivamente em preto e branco.", "Não possuírem balões de fala."], answer: "Terem um formato mais longo, com narrativas complexas e temas maduros.", hint: "Pense em obras como 'Maus' de Art Spiegelman ou 'Watchmen' de Alan Moore.", explanation: "'Graphic novel' designa histórias em quadrinhos com uma estrutura narrativa mais próxima de um romance, com enredos fechados, desenvolvimento profundo de personagens e, frequentemente, abordando temas mais complexos e adultos." },
            { question: "O que é um 'recordatório' em uma história em quadrinhos?", options: ["Um tipo especial de balão para gritos.", "Uma nota de rodapé explicando um termo.", "Um quadro que recapitula a história anterior.", "Uma caixa de texto, geralmente retangular, que contém a voz do narrador ou informações de tempo e lugar."], answer: "Uma caixa de texto, geralmente retangular, que contém a voz do narrador ou informações de tempo e lugar.", hint: "É a ferramenta que o quadrinista usa para dar informações que não vêm da fala dos personagens.", explanation: "O recordatório (ou legenda) é um recurso essencial para a narração, fornecendo contexto, descrições, ou pensamentos que não cabem nos diálogos, como 'Enquanto isso, em Gotham City...'." },
            { question: "Qual destas editoras é a principal concorrente da Marvel Comics, sendo a casa de personagens como Batman, Superman e Mulher-Maravilha?", options: ["Image Comics", "Dark Horse Comics", "DC Comics", "IDW Publishing"], answer: "DC Comics", hint: "Seu nome é uma abreviação de 'Detective Comics', a revista onde o Batman apareceu pela primeira vez.", explanation: "DC Comics e Marvel Comics são as duas maiores e mais antigas editoras de quadrinhos de super-heróis dos Estados Unidos, mantendo uma rivalidade histórica e publicando os personagens mais icônicos da cultura pop." },
            { question: "Na linguagem dos mangás, qual é a convenção de leitura padrão?", options: ["Da esquerda para a direita, de cima para baixo (ocidental).", "De baixo para cima, da direita para a esquerda.", "Da direita para a esquerda, de cima para baixo.", "Do centro da página para as bordas."], answer: "Da direita para a esquerda, de cima para baixo.", hint: "É o oposto da forma como lemos livros e revistas no ocidente.", explanation: "Para preservar a arte e a composição originais do autor (mangaká), a maioria dos mangás publicados no ocidente mantém o formato de leitura japonês, que é da direita para a esquerda." },
            { question: "A 'Era de Ouro' dos quadrinhos americanos (final dos anos 1930 a meados dos anos 1950) foi marcada pelo surgimento de qual arquétipo de personagem?", options: ["O anti-herói sombrio e violento.", "O super-herói patriótico e virtuoso.", "O mutante perseguido pela sociedade.", "O mago com poderes místicos."], answer: "O super-herói patriótico e virtuoso.", hint: "Pense no Superman original ou no Capitão América lutando na Segunda Guerra Mundial.", explanation: "A Era de Ouro foi definida pela criação do Superman em 1938, estabelecendo o molde do super-herói como uma figura poderosa, moralmente incorruptível e, muitas vezes, um símbolo de esperança e patriotismo, especialmente durante a guerra." },
            { question: "Qual o nome do criador da Turma da Mônica, um dos maiores ícones dos quadrinhos no Brasil?", options: ["Ziraldo", "Laerte", "Angeli", "Mauricio de Sousa"], answer: "Mauricio de Sousa", hint: "Ele se inspirou em seus próprios filhos para criar muitos dos personagens famosos.", explanation: "Mauricio de Sousa é o cartunista e empresário que criou um universo de personagens extremamente popular e duradouro, tornando a Turma da Mônica um fenômeno cultural no Brasil e no mundo." },
            { question: "O que significa o termo 'retcon' (retroactive continuity) no universo dos quadrinhos?", options: ["Uma edição especial comemorativa de uma série antiga.", "A prática de redesenhar um personagem com um novo uniforme.", "Alterar fatos previamente estabelecidos na história de um personagem ou universo.", "Um final alternativo para uma saga famosa."], answer: "Alterar fatos previamente estabelecidos na história de um personagem ou universo.", hint: "É como 'reescrever o passado' para ajustar uma história ou introduzir novas ideias.", explanation: "'Retcon' é uma ferramenta narrativa usada para adicionar, ignorar ou contradizer informações já estabelecidas, permitindo que os autores corrijam inconsistências ou modernizem personagens com décadas de história." },
            { question: "Em 'Watchmen', de Alan Moore, qual personagem usa uma máscara com manchas de tinta simétricas que mudam constantemente?", options: ["O Comediante", "Dr. Manhattan", "Rorschach", "Ozymandias"], answer: "Rorschach", hint: "Seu nome é uma referência a um famoso teste psicológico que usa manchas de tinta.", explanation: "A máscara de Rorschach é um dos elementos visuais mais marcantes dos quadrinhos. Feita de um tecido especial, suas manchas de tinta preta se movem e se reorganizam em padrões simétricos, refletindo seu estado mental e sua visão de mundo absolutista." }
        ];

        const startScreen = document.getElementById('start-screen');
        const mainContent = document.getElementById('main-content');
        const startBtn = document.getElementById('start-btn');
        const nicknameInput = document.getElementById('nickname-input');
        const quizForm = document.getElementById('quizForm');
        const resultsContainer = document.getElementById('results');
        const historyContainer = document.getElementById('history-container');
        const historyLog = document.getElementById('history-log');
        const tensionAudio = document.getElementById('tension-audio');
        const fastTickAudio = document.getElementById('fast-tick-audio');
        
        let currentUserName = "", currentQuestionIndex = 0, score = 0, multiplier = 1.0, maxMultiplier = 1.0, numCorrect = 0, timerInterval = null, scoreAnimationInterval = null, currentQuestionTimeLeft = 30;
        const basePoints = 100;

        function showHint(questionIndex) {
            document.getElementById(`hint${questionIndex}`).style.display = 'block';
            document.getElementById(`hint-btn${questionIndex}`).disabled = true;
        }

        function buildQuiz() {
            let output = [];
            quizData.forEach((q, i) => {
                let options = [];
                q.options.forEach(opt => {
                    options.push(`<label><input type="radio" name="question${i}" value="${opt}">${opt}</label>`);
                });
                output.push(
                    `<div class="question-block" id="q-block${i}">
                        <div class="timer-container">Tempo: <span class="timer" id="timer${i}">30</span>s</div>
                        <h3>${i + 1}. ${q.question}</h3>
                        <div class="options">${options.join('')}</div>
                        <div class="hint-container">
                            <button type="button" class="hint-btn" id="hint-btn${i}" onclick="showHint(${i})">Dica</button>
                            <div class="hint-text" id="hint${i}">${q.hint}</div>
                        </div>
                        <div class="explanation" id="explanation${i}">
                            <div class="explanation-text" style="display:none;">${q.explanation}</div>
                        </div>
                        <div class="action-buttons">
                            <button type="button" class="check-btn" id="check-btn${i}" onclick="checkAnswer(${i})">Verificar</button>
                            <button type="button" class="next-btn" id="next-btn${i}" onclick="nextQuestion()">Próxima</button>
                        </div>
                    </div>`
                );
            });
            quizForm.innerHTML = output.join('');
        }
        
        function updateScoreDisplay(from, to) {
            const scoreEl = document.getElementById('current-score');
            const duration = 500;
            if (from === to) {
                scoreEl.textContent = to;
                return;
            }
            if(scoreAnimationInterval) clearInterval(scoreAnimationInterval);
            let current = from;
            const increment = (to - from) / (duration / 10);
            scoreAnimationInterval = setInterval(() => {
                current += increment;
                if (current >= to) {
                    current = to;
                    clearInterval(scoreAnimationInterval);
                }
                scoreEl.textContent = Math.round(current);
            }, 10);
        }

        // --- NOVA FUNÇÃO PARA ATUALIZAR O STREAK ---
        function updateStreakDisplay() {
            const streakEl = document.getElementById('current-streak');
            streakEl.textContent = `${multiplier.toFixed(1)}x`;
            streakEl.classList.add('streak-updated');
            setTimeout(() => {
                streakEl.classList.remove('streak-updated');
            }, 500);
        }

        function startTimer(questionIndex) {
            currentQuestionTimeLeft = 30;
            const timerEl = document.getElementById(`timer${questionIndex}`);
            timerEl.textContent = currentQuestionTimeLeft;
            timerEl.classList.remove('warning');
            
            fastTickAudio.pause();
            tensionAudio.play().catch(e => {});

            timerInterval = setInterval(() => {
                currentQuestionTimeLeft--;
                timerEl.textContent = currentQuestionTimeLeft;
                if (currentQuestionTimeLeft <= 5 && currentQuestionTimeLeft > 0) {
                    timerEl.classList.add('warning');
                    tensionAudio.pause();
                    fastTickAudio.play();
                }
                if (currentQuestionTimeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeUp(questionIndex);
                }
            }, 1000);
        }

        function stopAllAudio() {
            tensionAudio.pause();
            fastTickAudio.pause();
        }
        
        function handleTimeUp(questionIndex) {
            stopAllAudio();
            const qBlock = document.getElementById(`q-block${questionIndex}`);
            const explanationEl = document.getElementById(`explanation${questionIndex}`);
            explanationEl.querySelector('.explanation-text').style.display = 'block';
            explanationEl.style.display = 'block';
            
            qBlock.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = true);
            document.getElementById(`check-btn${questionIndex}`).style.display = 'none';
            document.getElementById(`next-btn${questionIndex}`).style.display = 'block';
            qBlock.classList.add('incorrect');
            multiplier = 1.0;
            updateStreakDisplay(); // ATUALIZA O STREAK
            qBlock.querySelectorAll('.options label').forEach(label => {
                if (label.querySelector('input').value === quizData[questionIndex].answer) {
                    label.classList.add('correct-answer-highlight');
                }
            });
        }
        
        function checkAnswer(questionIndex) {
            clearInterval(timerInterval);
            stopAllAudio();
            const qBlock = document.getElementById(`q-block${questionIndex}`);
            const userAnswerNode = qBlock.querySelector(`input[name=question${questionIndex}]:checked`);
            const explanationEl = document.getElementById(`explanation${questionIndex}`);

            qBlock.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = true);
            document.getElementById(`check-btn${questionIndex}`).style.display = 'none';
            document.getElementById(`next-btn${questionIndex}`).style.display = 'block';
            explanationEl.style.display = 'block';
            explanationEl.querySelector('.explanation-text').style.display = 'block';

            if (userAnswerNode && userAnswerNode.value === quizData[questionIndex].answer) {
                numCorrect++;
                qBlock.classList.add('correct');
                userAnswerNode.parentElement.classList.add('correct-answer-highlight');
                
                const oldScore = score;
                const baseScore = Math.round(basePoints * multiplier);
                const timeBonus = currentQuestionTimeLeft * 3;
                
                score += baseScore + timeBonus;
                
                multiplier += 0.5;
                if (multiplier > maxMultiplier) maxMultiplier = multiplier;
                updateScoreDisplay(oldScore, score);
                updateStreakDisplay(); // ATUALIZA O STREAK

                const scoreBreakdownHTML = `
                    <div class="score-breakdown">
                        <div>Pontos Base (x${(multiplier - 0.5).toFixed(1)}): +${baseScore}</div>
                        <div>Bônus de Tempo (${currentQuestionTimeLeft}s): +${timeBonus}</div>
                        <div class="total-points">Total Ganho: +${baseScore + timeBonus}</div>
                    </div>`;
                explanationEl.insertAdjacentHTML('afterbegin', scoreBreakdownHTML);

            } else {
                qBlock.classList.add('incorrect');
                multiplier = 1.0;
                updateStreakDisplay(); // ATUALIZA O STREAK
                if (userAnswerNode) userAnswerNode.parentElement.classList.add('wrong-answer-highlight');
                qBlock.querySelectorAll('.options label').forEach(label => {
                    if (label.querySelector('input').value === quizData[questionIndex].answer) {
                        label.classList.add('correct-answer-highlight');
                    }
                });
            }
        }

        function nextQuestion() {
            document.getElementById(`q-block${currentQuestionIndex}`).classList.remove('active');
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                document.getElementById(`q-block${currentQuestionIndex}`).classList.add('active');
                startTimer(currentQuestionIndex);
            } else {
                showFinalResults();
            }
        }

        function showFinalResults() {
            stopAllAudio();
            document.getElementById('stats-container').style.display = 'none'; // Esconde o container de stats
            quizForm.style.display = 'none';
            const history = JSON.parse(localStorage.getItem('quizHistory')) || [];
            history.push({ name: currentUserName, score, date: new Date().toLocaleDateString('pt-BR'), dateISO: new Date().toISOString() });
            localStorage.setItem('quizHistory', JSON.stringify(history));

            let resultHTML = `<p id="results-text">Pontuação Final: ${score} pontos!</p>`;
            resultHTML += `<p id="results-extra">${numCorrect} acertos de ${quizData.length} questões. Maior multiplicador: ${maxMultiplier.toFixed(1)}x.</p>`;
            
            if (numCorrect / quizData.length >= 0.5) {
                resultHTML += `<p>Parabéns, você é um verdadeiro conhecedor!</p><img id="results-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNzlxYmZ1czZqdmo4NXB0NW9seW5wNXdsb2tkc2VtOHRnNGU3dGc1aiZlcD12MV9naWZzX3NlYXJjaCZjdD1n/uxXNV3Xa7QqME/giphy.gif" alt="GIF de Sucesso">`;
            } else {
                 resultHTML += `<p>Não desanime! Continue tentando!</p><img id="results-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExaXN1dG56eG1jYmN5Z2JjZ3NqYnF6c2ZkM2N2a3R1c3N6dGpyc3h4eCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/yoJC2GnS5peXXt1g32/giphy.gif" alt="GIF de Tente Novamente">`;
            }
            resultsContainer.innerHTML = resultHTML;
            resultsContainer.style.display = 'block';
            displayHistory();
            historyContainer.style.display = 'block';
        }

        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('quizHistory')) || [];
            if (history.length === 0) {
                historyLog.innerHTML = "<p>Seja o primeiro a entrar no ranking!</p>"; return;
            }
            history.sort((a, b) => b.score - a.score || new Date(b.dateISO) - new Date(a.dateISO));
            let tableHTML = `<table><thead><tr><th>Pos.</th><th>Nome</th><th>Pontuação</th><th>Data</th></tr></thead><tbody>`;
            history.forEach((e, i) => {
                tableHTML += `<tr><td>${i + 1}º</td><td>${e.name}</td><td>${e.score} pts</td><td>${e.date}</td></tr>`;
            });
            tableHTML += "</tbody></table>";
            historyLog.innerHTML = tableHTML;
        }
        
        startBtn.addEventListener('click', () => {
            tensionAudio.play().catch(e => {});
            tensionAudio.pause();
            fastTickAudio.play().catch(e => {});
            fastTickAudio.pause();
            
            currentUserName = nicknameInput.value.trim() || "Herói Anônimo";
            startScreen.style.display = 'none';
            mainContent.style.display = 'block';

            currentQuestionIndex = 0; score = 0; multiplier = 1.0; maxMultiplier = 1.0; numCorrect = 0;
            updateScoreDisplay(0, 0);
            updateStreakDisplay(); // ATUALIZA O STREAK
            document.getElementById('stats-container').style.display = 'flex'; // Mostra o container de stats
            quizForm.style.display = 'block';
            resultsContainer.style.display = 'none';
            historyContainer.style.display = 'none';

            document.getElementById('q-block0').classList.add('active');
            startTimer(0);
        });

        document.addEventListener('DOMContentLoaded', () => {
            buildQuiz();
        });
    </script>
</body>
</html>